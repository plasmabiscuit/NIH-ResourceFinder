const{useEffect,useMemo,useRef,useState}=React,uniqueSorted=e=>Array.from(new Set(e.filter(Boolean))).sort((l,t)=>l.localeCompare(t,void 0,{sensitivity:"base"})),normalizeResource=(e,l)=>{var o,r,q,d,T,S,b,p,_,x,j,u,R,g,M,f,I,y,A,w,L,v,k,C,h,m,N,D,U,s,n,i,a,c,B,F,O,P,E,z,H,$,Q,W,J;const t=(r=(o=e.lifecycle_curation)==null?void 0:o.maintaining_ic)!=null?r:[];return{id:(d=(q=e.identity)==null?void 0:q.id)!=null?d:`resource-${l}`,name:(S=(T=e.identity)==null?void 0:T.resource_name)!=null?S:"Untitled Resource",shortName:(p=(b=e.identity)==null?void 0:b.short_name)!=null?p:"",icCode:(x=(_=e.identity)==null?void 0:_.ic_code)!=null?x:"",icName:(u=(j=e.identity)==null?void 0:j.ic_name)!=null?u:"",primaryUrl:(g=(R=e.identity)==null?void 0:R.primary_url)!=null?g:"",docsUrl:(f=(M=e.identity)==null?void 0:M.docs_url)!=null?f:"",apiUrl:(y=(I=e.identity)==null?void 0:I.api_url)!=null?y:"",resourceTypes:(w=(A=e.type_content)==null?void 0:A.resource_type)!=null?w:[],domains:(v=(L=e.type_content)==null?void 0:L.domains)!=null?v:[],costStatus:(C=(k=e.access_cost)==null?void 0:k.cost_status)!=null?C:"",accessModel:(m=(h=e.access_cost)==null?void 0:h.access_model)!=null?m:"",requiresDua:!!((N=e.access_cost)!=null&&N.requires_dua),requiresRegistration:!!((D=e.access_cost)!=null&&D.requires_registration),dataSensitivity:(s=(U=e.access_cost)==null?void 0:U.data_sensitivity)!=null?s:"",hasHumanData:!!((n=e.access_cost)!=null&&n.has_human_data),maintainingICs:t.length?t:[],computeLocation:(a=(i=e.practical_usage)==null?void 0:i.compute_location)!=null?a:[],skillsRequired:(B=(c=e.practical_usage)==null?void 0:c.skills_required)!=null?B:[],typicalUseCases:(O=(F=e.practical_usage)==null?void 0:F.typical_use_cases)!=null?O:"",integrationParents:(E=(P=e.practical_usage)==null?void 0:P.integration_parents)!=null?E:[],notes:(H=(z=e.lifecycle_curation)==null?void 0:z.notes)!=null?H:"",status:(Q=($=e.lifecycle_curation)==null?void 0:$.status)!=null?Q:"",keywords:(J=(W=e.tagging)==null?void 0:W.keywords)!=null?J:[]}},createSearchIndex=e=>{if(!window.FlexSearch)return null;const l=new window.FlexSearch.Index({tokenize:"forward",cache:!0,preset:"match"});return e.forEach(t=>{const o=[t.name,t.shortName,t.icCode,t.icName,t.resourceTypes.join(" "),t.domains.join(" "),t.typicalUseCases,t.skillsRequired.join(" "),t.keywords.join(" "),t.notes].filter(Boolean).join(" ");l.add(t.id,o)}),l},FilterSection=({title:e,options:l,selected:t,onToggle:o})=>React.createElement("div",{className:"mb-6"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h3",{className:"text-xs font-semibold tracking-wider text-slate-500 uppercase"},e),t.length>0&&React.createElement("span",{className:"text-[11px] font-medium text-indigo-600"},t.length," selected")),React.createElement("div",{className:"mt-2 space-y-1 max-h-48 overflow-auto pr-2"},l.length===0?React.createElement("p",{className:"text-xs text-slate-400"},"No options"):l.map(r=>React.createElement("label",{key:r,className:"flex cursor-pointer items-center space-x-2 text-sm text-slate-700"},React.createElement("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500",checked:t.includes(r),onChange:()=>o(r)}),React.createElement("span",null,r))))),ExternalLink=({label:e,url:l})=>React.createElement("a",{href:l||void 0,target:"_blank",rel:"noreferrer",className:`inline-flex items-center justify-between rounded-lg border px-3 py-2 text-sm font-medium transition ${l?"border-indigo-200 text-indigo-600 hover:bg-indigo-50":"cursor-not-allowed border-slate-200 text-slate-400"}`,"aria-disabled":!l},React.createElement("span",null,e),React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2 h-4 w-4"},React.createElement("path",{d:"M9 7h8m0 0v8m0-8L7 17"}))),ResourceCard=({resource:e,onSelect:l,isActive:t})=>React.createElement("div",{className:`rounded-2xl border p-4 shadow-sm transition hover:shadow-md cursor-pointer ${t?"border-indigo-400 bg-indigo-50/60":"border-slate-200 bg-white"}`,onClick:()=>l(e)},React.createElement("div",{className:"flex items-start justify-between"},React.createElement("div",null,React.createElement("h3",{className:"text-lg font-semibold text-slate-900"},e.name),React.createElement("p",{className:"text-sm text-slate-500"},e.shortName||e.icName||e.icCode)),React.createElement("span",{className:"rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-700"},e.icCode||"IC")),React.createElement("div",{className:"mt-4 flex flex-wrap gap-2"},e.resourceTypes.slice(0,3).map(o=>React.createElement("span",{key:o,className:"rounded-full bg-indigo-100 px-3 py-1 text-xs font-medium text-indigo-700"},o))),e.domains.length>0&&React.createElement("div",{className:"mt-3 text-xs text-slate-500"},e.domains.slice(0,3).join(" \xB7 "),e.domains.length>3?` +${e.domains.length-3} more`:""),e.typicalUseCases&&React.createElement("p",{className:"mt-3 text-sm text-slate-600"},e.typicalUseCases),React.createElement("div",{className:"mt-4 flex flex-wrap items-center gap-2 text-xs text-slate-500"},e.costStatus&&React.createElement("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-3 py-1 font-medium text-emerald-700"},React.createElement("span",{className:"h-2 w-2 rounded-full bg-emerald-500"})," ",e.costStatus),e.accessModel&&React.createElement("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-50 px-3 py-1 font-medium text-blue-700"},React.createElement("span",{className:"h-2 w-2 rounded-full bg-blue-500"})," ",e.accessModel))),DetailPanel=({resource:e})=>e?React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm"},React.createElement("div",{className:"flex items-start justify-between gap-4"},React.createElement("div",null,React.createElement("h2",{className:"text-2xl font-semibold text-slate-900"},e.name),React.createElement("p",{className:"text-sm text-slate-500"},e.shortName||e.icName||e.icCode)),React.createElement("span",{className:"rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-700"},e.status||"Active")),React.createElement("div",{className:"mt-6 grid gap-4 text-sm text-slate-700"},React.createElement("div",{className:"grid gap-1"},React.createElement("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500"},"Identity"),React.createElement("p",{className:"font-medium text-slate-900"},e.icName||"Maintaining IC"),React.createElement("p",{className:"text-slate-500"},e.maintainingICs.length?e.maintainingICs.join(", "):e.icCode||"Not specified")),React.createElement("div",null,React.createElement("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500"},"Domains"),React.createElement("p",null,e.domains.join(", ")||"Not specified"))),React.createElement("div",{className:"mt-8"},React.createElement("h3",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500"},"Access snapshot"),React.createElement("div",{className:"mt-3 grid gap-3 text-sm"},React.createElement("div",{className:"rounded-xl border border-slate-100 bg-slate-50 p-3"},React.createElement("p",{className:"text-xs font-semibold uppercase text-slate-500"},"Cost Status"),React.createElement("p",{className:"text-slate-900"},e.costStatus||"Not specified")),React.createElement("div",{className:"rounded-xl border border-slate-100 bg-slate-50 p-3"},React.createElement("p",{className:"text-xs font-semibold uppercase text-slate-500"},"Access Model"),React.createElement("p",{className:"text-slate-900"},e.accessModel||"Not specified")),React.createElement("div",{className:"rounded-xl border border-slate-100 bg-slate-50 p-3"},React.createElement("p",{className:"text-xs font-semibold uppercase text-slate-500"},"Data Sensitivity"),React.createElement("p",{className:"text-slate-900"},e.dataSensitivity||"Not specified")),React.createElement("div",{className:"rounded-xl border border-slate-100 bg-slate-50 p-3"},React.createElement("p",{className:"text-xs font-semibold uppercase text-slate-500"},"Requirements"),React.createElement("p",{className:"text-slate-900"},e.requiresRegistration?"Registration required":"No registration"," \xB7"," ",e.requiresDua?"DUA required":"No DUA")))),React.createElement("div",{className:"mt-8"},React.createElement("h3",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500"},"Practical usage"),React.createElement("dl",{className:"mt-3 space-y-2 text-sm"},React.createElement("div",null,React.createElement("dt",{className:"text-slate-500"},"Typical use cases"),React.createElement("dd",{className:"text-slate-900"},e.typicalUseCases||"Not specified")),React.createElement("div",null,React.createElement("dt",{className:"text-slate-500"},"Skills required"),React.createElement("dd",{className:"text-slate-900"},e.skillsRequired.length?e.skillsRequired.join(", "):"Not specified")),React.createElement("div",null,React.createElement("dt",{className:"text-slate-500"},"Compute / access location"),React.createElement("dd",{className:"text-slate-900"},e.computeLocation.length?e.computeLocation.join(", "):"Not specified")),React.createElement("div",null,React.createElement("dt",{className:"text-slate-500"},"Parent / Integrations"),React.createElement("dd",{className:"text-slate-900"},e.integrationParents.length?e.integrationParents.join(", "):"None")))),React.createElement("div",{className:"mt-8"},React.createElement("h3",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500"},"Actionable links"),React.createElement("div",{className:"mt-3 flex flex-wrap gap-3"},React.createElement(ExternalLink,{label:"Primary URL",url:e.primaryUrl}),React.createElement(ExternalLink,{label:"Docs",url:e.docsUrl}),React.createElement(ExternalLink,{label:"API",url:e.apiUrl}))),e.keywords.length>0&&React.createElement("div",{className:"mt-8"},React.createElement("h3",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500"},"Keywords"),React.createElement("div",{className:"mt-3 flex flex-wrap gap-2 text-xs"},e.keywords.map(l=>React.createElement("span",{key:l,className:"rounded-full bg-slate-100 px-3 py-1 font-medium text-slate-600"},l)))),e.notes&&React.createElement("div",{className:"mt-8 rounded-xl bg-amber-50 p-4 text-sm text-amber-800"},React.createElement("p",{className:"font-semibold"},"Notes"),React.createElement("p",null,e.notes))):React.createElement("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-white p-8 text-center text-slate-500"},"Select a resource to view details."),App=()=>{const[e,l]=useState(!0),[t,o]=useState([]),[r,q]=useState(""),[d,T]=useState(""),[S,b]=useState([]),[p,_]=useState([]),[x,j]=useState([]),[u,R]=useState([]),[g,M]=useState([]),[f,I]=useState([]),[y,A]=useState(!1),[w,L]=useState(!1),[v,k]=useState(null),C=useRef(null);useEffect(()=>{(async()=>{try{const n=await fetch("resources.json");if(!n.ok)throw new Error("Failed to load resources");const a=(await n.json()).map(normalizeResource);o(a),b(a.map(c=>c.id)),C.current=createSearchIndex(a)}catch(n){console.error(n),q("Unable to load the resource catalogue at this time.")}finally{l(!1)}})()},[]),useEffect(()=>{if(!d){b(t.map(s=>s.id));return}if(C.current){const s=C.current.search(d,100);b(Array.isArray(s)?s:[])}else{const s=d.toLowerCase(),n=t.filter(i=>[i.name,i.shortName,i.icCode,i.icName,i.domains.join(" "),i.resourceTypes.join(" "),i.typicalUseCases,i.keywords.join(" ")].filter(Boolean).some(a=>a.toLowerCase().includes(s))).map(i=>i.id);b(n)}},[d,t]);const h=useMemo(()=>({ics:uniqueSorted(t.flatMap(s=>s.maintainingICs.length?s.maintainingICs:s.icCode?[s.icCode]:[])),domains:uniqueSorted(t.flatMap(s=>s.domains)),resourceTypes:uniqueSorted(t.flatMap(s=>s.resourceTypes)),dataSensitivity:uniqueSorted(t.map(s=>s.dataSensitivity)),accessModels:uniqueSorted(t.map(s=>s.accessModel))}),[t]),m=useMemo(()=>{const s=new Map(t.map(a=>[a.id,a]));let i=[...d?S.map(a=>s.get(a)).filter(Boolean):t];return d&&i.length===0?[]:(p.length&&(i=i.filter(a=>(a.maintainingICs.length?a.maintainingICs:a.icCode?[a.icCode]:[]).some(B=>p.includes(B)))),x.length&&(i=i.filter(a=>a.domains.some(c=>x.includes(c)))),u.length&&(i=i.filter(a=>a.resourceTypes.some(c=>u.includes(c)))),g.length&&(i=i.filter(a=>g.includes(a.dataSensitivity))),f.length&&(i=i.filter(a=>f.includes(a.accessModel))),y&&(i=i.filter(a=>(a.costStatus||"").toLowerCase().includes("free"))),w&&(i=i.filter(a=>(a.accessModel||"").toLowerCase().includes("open access"))),i)},[t,d,S,p,x,u,g,f,y,w]);useEffect(()=>{if(!m.length){k(null);return}k(s=>s&&m.some(n=>n.id===s.id)?s:m[0])},[m]);const N=(s,n,i)=>{i(a=>a.includes(s)?a.filter(c=>c!==s):[...a,s])},D=()=>{_([]),j([]),R([]),M([]),I([]),A(!1),L(!1)};if(e)return React.createElement("div",{className:"flex min-h-screen items-center justify-center text-slate-500"},"Loading resources...");if(r)return React.createElement("div",{className:"flex min-h-screen flex-col items-center justify-center space-y-3 text-center"},React.createElement("p",{className:"text-lg font-semibold text-slate-800"},r),React.createElement("p",{className:"text-sm text-slate-500"},"Check the JSON file and reload the page."));const U=m.length;return React.createElement("div",{className:"mx-auto max-w-7xl px-4 py-8 lg:px-8"},React.createElement("header",{className:"mb-8"},React.createElement("p",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-indigo-600"},"NIH Resource Finder"),React.createElement("div",{className:"mt-2 flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between"},React.createElement("div",null,React.createElement("h1",{className:"text-3xl font-bold text-slate-900"},"Search, filter, and launch NIH-supported research resources"),React.createElement("p",{className:"mt-2 max-w-3xl text-base text-slate-600"},"Explore data repositories, biospecimen banks, and analysis tools. Use the instant search and curated filters to zero-in on what matters: institute alignment, domain focus, access model, and cost.")),React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-3 text-right shadow-sm"},React.createElement("p",{className:"text-3xl font-semibold text-slate-900"},t.length),React.createElement("p",{className:"text-xs uppercase tracking-widest text-slate-500"},"Total resources")))),React.createElement("div",{className:"grid gap-6 lg:grid-cols-[280px,1fr,360px]"},React.createElement("aside",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h2",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500"},"Filters"),React.createElement("button",{className:"text-xs font-semibold text-indigo-600 hover:text-indigo-500",onClick:D},"Clear all")),React.createElement("div",{className:"mt-4 rounded-xl bg-slate-50 p-3 text-xs text-slate-600"},React.createElement("p",{className:"font-semibold text-slate-800"},"Access focus"),React.createElement("label",{className:"mt-2 flex items-center justify-between"},React.createElement("span",null,"Free only"),React.createElement("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500",checked:y,onChange:s=>A(s.target.checked)})),React.createElement("label",{className:"mt-2 flex items-center justify-between"},React.createElement("span",null,"Open access only"),React.createElement("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500",checked:w,onChange:s=>L(s.target.checked)}))),React.createElement(FilterSection,{title:"Maintaining IC",options:h.ics,selected:p,onToggle:s=>N(s,p,_)}),React.createElement(FilterSection,{title:"Domain",options:h.domains,selected:x,onToggle:s=>N(s,x,j)}),React.createElement(FilterSection,{title:"Resource type",options:h.resourceTypes,selected:u,onToggle:s=>N(s,u,R)}),React.createElement(FilterSection,{title:"Data sensitivity",options:h.dataSensitivity,selected:g,onToggle:s=>N(s,g,M)}),React.createElement(FilterSection,{title:"Access model",options:h.accessModels,selected:f,onToggle:s=>N(s,f,I)})),React.createElement("main",{className:"space-y-4"},React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm"},React.createElement("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:gap-4"},React.createElement("div",{className:"flex-1"},React.createElement("label",{className:"sr-only",htmlFor:"resource-search"},"Search resources"),React.createElement("div",{className:"relative"},React.createElement("span",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-slate-400"},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M10.5 3.75a6.75 6.75 0 1 1 0 13.5 6.75 6.75 0 0 1 0-13.5zm0 0L16.5 15"}))),React.createElement("input",{id:"resource-search",type:"search",placeholder:"Search by resource name, domain, or keyword",value:d,onChange:s=>T(s.target.value),className:"w-full rounded-xl border border-slate-200 bg-slate-50 py-3 pl-10 pr-4 text-sm text-slate-700 focus:border-indigo-400 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100"}))),React.createElement("div",{className:"flex items-center gap-3 text-sm text-slate-500"},React.createElement("span",{className:"text-sm font-semibold text-slate-900"},U),"results"))),U===0?React.createElement("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-white p-10 text-center text-slate-500"},React.createElement("p",{className:"text-lg font-semibold text-slate-700"},"No resources found"),React.createElement("p",{className:"mt-2 text-sm text-slate-500"},"Adjust your filters or search query to discover more NIH resources.")):React.createElement("div",{className:"space-y-4"},m.map(s=>React.createElement(ResourceCard,{key:s.id,resource:s,isActive:(v==null?void 0:v.id)===s.id,onSelect:k})))),React.createElement("section",{className:"sticky top-6 h-fit"},React.createElement(DetailPanel,{resource:v}))))};ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(App,null));
