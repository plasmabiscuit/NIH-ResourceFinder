const{useEffect,useMemo,useRef,useState}=React,uniqueSorted=e=>Array.from(new Set(e.filter(Boolean))).sort((o,s)=>o.localeCompare(s,void 0,{sensitivity:"base"})),normalizeResource=(e,o)=>{var l,r,c,g,v,h,x,m,b,a,d,N,y,w,C,k,I,f,R,A,S,_,D,t,p,i,n,u,M,L,H,j,T,B,U,q,$,E,F,G,O,P,K,V,z;const s=(r=(l=e.lifecycle_curation)==null?void 0:l.maintaining_ic)!=null?r:[];return{id:(g=(c=e.identity)==null?void 0:c.id)!=null?g:`resource-${o}`,name:(h=(v=e.identity)==null?void 0:v.resource_name)!=null?h:"Untitled Resource",shortName:(m=(x=e.identity)==null?void 0:x.short_name)!=null?m:"",icCode:(a=(b=e.identity)==null?void 0:b.ic_code)!=null?a:"",icName:(N=(d=e.identity)==null?void 0:d.ic_name)!=null?N:"",primaryUrl:(w=(y=e.identity)==null?void 0:y.primary_url)!=null?w:"",docsUrl:(k=(C=e.identity)==null?void 0:C.docs_url)!=null?k:"",apiUrl:(f=(I=e.identity)==null?void 0:I.api_url)!=null?f:"",resourceTypes:(A=(R=e.type_content)==null?void 0:R.resource_type)!=null?A:[],domains:(_=(S=e.type_content)==null?void 0:S.domains)!=null?_:[],costStatus:(t=(D=e.access_cost)==null?void 0:D.cost_status)!=null?t:"",accessModel:(i=(p=e.access_cost)==null?void 0:p.access_model)!=null?i:"",requiresDua:!!((n=e.access_cost)!=null&&n.requires_dua),requiresRegistration:!!((u=e.access_cost)!=null&&u.requires_registration),dataSensitivity:(L=(M=e.access_cost)==null?void 0:M.data_sensitivity)!=null?L:"",hasHumanData:!!((H=e.access_cost)!=null&&H.has_human_data),maintainingICs:s.length?s:[],computeLocation:(T=(j=e.practical_usage)==null?void 0:j.compute_location)!=null?T:[],skillsRequired:(U=(B=e.practical_usage)==null?void 0:B.skills_required)!=null?U:[],typicalUseCases:($=(q=e.practical_usage)==null?void 0:q.typical_use_cases)!=null?$:"",integrationParents:(F=(E=e.practical_usage)==null?void 0:E.integration_parents)!=null?F:[],notes:(O=(G=e.lifecycle_curation)==null?void 0:G.notes)!=null?O:"",status:(K=(P=e.lifecycle_curation)==null?void 0:P.status)!=null?K:"",keywords:(z=(V=e.tagging)==null?void 0:V.keywords)!=null?z:[]}},createSearchIndex=e=>{if(!window.FlexSearch)return null;const o=new window.FlexSearch.Index({tokenize:"forward",cache:!0,preset:"match"});return e.forEach(s=>{const l=[s.name,s.shortName,s.icCode,s.icName,s.resourceTypes.join(" "),s.domains.join(" "),s.typicalUseCases,s.skillsRequired.join(" "),s.keywords.join(" "),s.notes].filter(Boolean).join(" ");o.add(s.id,l)}),o},LOGO_LIBRARY={CC:{small:"abrv-logos/CC.svg",large:"png-logos/CC.png"},CIT:{small:"abrv-logos/CIT.svg",large:"png-logos/CIT.png"},CSR:{small:"abrv-logos/CSR.svg",large:"png-logos/CSR.png"},FIC:{small:"abrv-logos/FIC.svg",large:"png-logos/FIC.png"},NCATS:{small:"abrv-logos/NCATS.svg",large:"png-logos/NCATS.png"},NCCIH:{small:"abrv-logos/NCCIH.svg",large:"png-logos/NCCIH.png"},NCI:{small:"abrv-logos/NCI.svg",large:"png-logos/NCI.png"},NEI:{small:"abrv-logos/NEI.svg",large:"png-logos/NEI.png"},NIEHS:{small:"abrv-logos/NEIHS.svg",large:"png-logos/NIEHS.png"},NHGRI:{small:"abrv-logos/NHGRI.svg",large:"png-logos/NHGRI.png"},NHLBI:{small:"abrv-logos/NHLBI.svg",large:"png-logos/NHLBI.png"},NIA:{small:"abrv-logos/NIA.svg",large:"png-logos/NIA.png"},NIAAA:{small:"abrv-logos/NIAAA.svg",large:"png-logos/NIAAA.png"},NIAID:{small:"abrv-logos/NIAID.svg",large:"png-logos/niaid.png"},NIAMS:{small:"abrv-logos/NIAMS.svg",large:"png-logos/NIAMSD.png"},NIBIB:{small:"abrv-logos/NIBIB.svg",large:"png-logos/NIBIB.png"},NICHD:{small:"abrv-logos/NICHD.svg",large:"png-logos/NICHHD.png"},NIDA:{small:"abrv-logos/NIDA.svg",large:"png-logos/NIDA.png"},NIDCD:{small:"abrv-logos/NIDCD.svg",large:"png-logos/NIDCD.png"},NIDCR:{small:"abrv-logos/NIDCR.svg",large:"png-logos/NIDCR.png"},NIDDK:{small:"abrv-logos/NIDDK.svg",large:"png-logos/NIDDK.png"},NIGMS:{small:"abrv-logos/NIGMS.svg",large:"png-logos/NIGMS.png"},NIMH:{small:"abrv-logos/NIMH.svg",large:"png-logos/NIMH.png"},NIMHD:{small:"abrv-logos/NIMHD.svg",large:"png-logos/NIMHHD.png"},NINDS:{small:"abrv-logos/NINDS.svg",large:"png-logos/NINDS.png"},NINR:{small:"abrv-logos/NINR.svg",large:"png-logos/NINR.png"},NLM:{small:"abrv-logos/NLM.svg",large:"png-logos/NLM.png"}},getIcAssets=e=>{const o=(e||"").toUpperCase(),s=LOGO_LIBRARY[o]||{};return{code:e,small:s.small||null,large:s.large||s.small||null}},MaintainerLogoRow=({ics:e,size:o="small"})=>e.length?React.createElement("div",{className:`flex flex-wrap items-center ${o==="large"?"gap-3":"gap-2"}`,"aria-label":"Maintaining IC logos"},e.map((s,l)=>{const r=getIcAssets(s),c=o==="large"?r.large:r.small||r.large;return c?React.createElement("img",{key:`${s}-${l}-${o}`,src:c,alt:`${r.code||"IC"} logo`,className:o==="large"?"h-12 w-auto":"h-8 w-8"}):React.createElement("span",{key:`${s}-${l}-${o}`,className:`rounded-full bg-slate-100 font-semibold text-slate-600 ${o==="large"?"px-3 py-1 text-sm":"px-2 py-0.5 text-xs"}`},r.code)})):null,LogoFilterGrid=({options:e,selected:o,onToggle:s})=>e.length?React.createElement("div",null,React.createElement("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500"},"Filter by IC logo"),React.createElement("div",{className:"mt-3 flex flex-wrap gap-3"},e.map(l=>{const r=getIcAssets(l);if(!r.small)return null;const c=o.includes(l);return React.createElement("button",{type:"button",key:l,onClick:()=>s(l),className:`flex h-14 w-14 items-center justify-center rounded-2xl border bg-white p-2 shadow-sm transition ${c?"border-indigo-500 ring-2 ring-indigo-200":"border-slate-200 hover:border-slate-300"}`},React.createElement("img",{src:r.small,alt:`${l} logo`,className:"h-full w-full object-contain"}))}))):null,MultiEntryInput=({label:e,placeholder:o,options:s,values:l,onChange:r})=>{const[c,g]=useState(""),v=useMemo(()=>s.map(a=>({label:a,match:a.toLowerCase()})),[s]),h=a=>{const d=a.trim();if(!d)return;const N=v.find(w=>w.match===d.toLowerCase()),y=N?N.label:d;l.includes(y)||r([...l,y])},x=a=>{r(l.filter(d=>d!==a))},m=a=>{(a.key==="Enter"||a.key==="Tab")&&c.trim()&&(a.preventDefault(),h(c),g("")),a.key==="Backspace"&&!c&&l.length&&x(l[l.length-1])},b=useMemo(()=>{if(!c)return v.map(d=>d.label).filter(d=>!l.includes(d)).slice(0,6);const a=c.toLowerCase();return v.filter(d=>d.match.includes(a)&&!l.includes(d.label)).map(d=>d.label).slice(0,6)},[c,v,l]);return React.createElement("div",null,React.createElement("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500"},e),React.createElement("div",{className:"mt-2 rounded-2xl border border-slate-200 bg-white"},React.createElement("div",{className:"flex flex-wrap gap-2 p-3"},l.map(a=>React.createElement("span",{key:a,className:"inline-flex items-center gap-1 rounded-full bg-indigo-50 px-3 py-1 text-xs font-semibold text-indigo-700"},a,React.createElement("button",{type:"button",onClick:()=>x(a),className:"text-indigo-500 hover:text-indigo-700","aria-label":`Remove ${a}`},"\xD7"))),React.createElement("input",{type:"text",value:c,onChange:a=>g(a.target.value),onKeyDown:m,placeholder:l.length?"Add more\u2026":o,className:"min-w-[120px] flex-1 border-0 bg-transparent text-sm text-slate-700 focus:outline-none"}))),b.length>0&&React.createElement("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-slate-500"},b.map(a=>React.createElement("button",{key:a,type:"button",onClick:()=>{h(a),g("")},className:"rounded-full border border-slate-200 px-3 py-1 hover:border-indigo-300 hover:text-indigo-600"},a))))},ExternalLink=({label:e,url:o})=>React.createElement("a",{href:o||void 0,target:"_blank",rel:"noreferrer",className:`inline-flex items-center justify-between rounded-lg border px-3 py-2 text-sm font-medium transition ${o?"border-indigo-200 text-indigo-600 hover:bg-indigo-50":"cursor-not-allowed border-slate-200 text-slate-400"}`,"aria-disabled":!o},React.createElement("span",null,e),React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2 h-4 w-4"},React.createElement("path",{d:"M9 7h8m0 0v8m0-8L7 17"}))),ResourceCard=({resource:e,onToggle:o,isExpanded:s})=>{const l=e.maintainingICs.length?e.maintainingICs:e.icCode?[e.icCode]:[];return React.createElement("div",{className:`rounded-2xl border p-5 shadow-sm transition ${s?"border-indigo-400 bg-white shadow-md":"border-slate-200 bg-white hover:shadow-md"}`},React.createElement("button",{type:"button",className:"flex w-full items-start justify-between gap-4 text-left",onClick:()=>o(e.id),"aria-expanded":s},React.createElement("div",{className:"space-y-2"},React.createElement("div",null,React.createElement("h3",{className:"text-lg font-semibold text-slate-900"},e.name),React.createElement("p",{className:"text-sm text-slate-500"},e.shortName||e.icName||l.join(", ")||"NIH Resource")),e.typicalUseCases&&React.createElement("p",{className:"text-sm text-slate-600"},e.typicalUseCases)),React.createElement("div",{className:"flex flex-col items-end gap-2"},React.createElement(MaintainerLogoRow,{ics:l,size:"small"}),React.createElement("span",{className:"text-xs font-medium text-indigo-600"},s?"Hide details":"View details"))),React.createElement("div",{className:"mt-4 flex flex-wrap gap-2"},e.resourceTypes.slice(0,3).map(r=>React.createElement("span",{key:r,className:"rounded-full bg-indigo-100 px-3 py-1 text-xs font-medium text-indigo-700"},r))),e.domains.length>0&&React.createElement("div",{className:"mt-3 text-xs text-slate-500"},e.domains.slice(0,3).join(" \xB7 "),e.domains.length>3?` +${e.domains.length-3} more`:""),s&&React.createElement("div",{className:"mt-6 space-y-6 border-t border-slate-200 pt-6 text-sm text-slate-700"},React.createElement(MaintainerLogoRow,{ics:l,size:"large"}),React.createElement("div",{className:"grid gap-4 sm:grid-cols-2"},React.createElement("div",null,React.createElement("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500"},"Domains"),React.createElement("p",{className:"mt-1"},e.domains.join(", ")||"Not specified")),React.createElement("div",null,React.createElement("span",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500"},"Status"),React.createElement("p",{className:"mt-1"},e.status||"Active"))),React.createElement("div",null,React.createElement("h4",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500"},"Access snapshot"),React.createElement("div",{className:"mt-3 grid gap-3 md:grid-cols-2"},React.createElement("div",{className:"rounded-xl border border-slate-100 bg-slate-50 p-3"},React.createElement("p",{className:"text-xs font-semibold uppercase text-slate-500"},"Cost Status"),React.createElement("p",{className:"text-slate-900"},e.costStatus||"Not specified")),React.createElement("div",{className:"rounded-xl border border-slate-100 bg-slate-50 p-3"},React.createElement("p",{className:"text-xs font-semibold uppercase text-slate-500"},"Access Model"),React.createElement("p",{className:"text-slate-900"},e.accessModel||"Not specified")),React.createElement("div",{className:"rounded-xl border border-slate-100 bg-slate-50 p-3"},React.createElement("p",{className:"text-xs font-semibold uppercase text-slate-500"},"Data Sensitivity"),React.createElement("p",{className:"text-slate-900"},e.dataSensitivity||"Not specified")),React.createElement("div",{className:"rounded-xl border border-slate-100 bg-slate-50 p-3"},React.createElement("p",{className:"text-xs font-semibold uppercase text-slate-500"},"Requirements"),React.createElement("p",{className:"text-slate-900"},e.requiresRegistration?"Registration required":"No registration"," \xB7"," ",e.requiresDua?"DUA required":"No DUA")))),React.createElement("div",null,React.createElement("h4",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500"},"Practical usage"),React.createElement("dl",{className:"mt-3 space-y-2"},React.createElement("div",null,React.createElement("dt",{className:"text-slate-500"},"Typical use cases"),React.createElement("dd",{className:"text-slate-900"},e.typicalUseCases||"Not specified")),React.createElement("div",null,React.createElement("dt",{className:"text-slate-500"},"Skills required"),React.createElement("dd",{className:"text-slate-900"},e.skillsRequired.length?e.skillsRequired.join(", "):"Not specified")),React.createElement("div",null,React.createElement("dt",{className:"text-slate-500"},"Compute / access location"),React.createElement("dd",{className:"text-slate-900"},e.computeLocation.length?e.computeLocation.join(", "):"Not specified")),React.createElement("div",null,React.createElement("dt",{className:"text-slate-500"},"Parent / Integrations"),React.createElement("dd",{className:"text-slate-900"},e.integrationParents.length?e.integrationParents.join(", "):"None")))),React.createElement("div",null,React.createElement("h4",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500"},"Actionable links"),React.createElement("div",{className:"mt-3 flex flex-wrap gap-3"},React.createElement(ExternalLink,{label:"Primary URL",url:e.primaryUrl}),React.createElement(ExternalLink,{label:"Docs",url:e.docsUrl}),React.createElement(ExternalLink,{label:"API",url:e.apiUrl}))),e.keywords.length>0&&React.createElement("div",null,React.createElement("h4",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500"},"Keywords"),React.createElement("div",{className:"mt-3 flex flex-wrap gap-2 text-xs"},e.keywords.map(r=>React.createElement("span",{key:r,className:"rounded-full bg-slate-100 px-3 py-1 font-medium text-slate-600"},r)))),e.notes&&React.createElement("div",{className:"rounded-xl bg-amber-50 p-4 text-sm text-amber-800"},React.createElement("p",{className:"font-semibold"},"Notes"),React.createElement("p",null,e.notes))))},App=()=>{const[e,o]=useState(!0),[s,l]=useState([]),[r,c]=useState(""),[g,v]=useState(""),[h,x]=useState([]),[m,b]=useState([]),[a,d]=useState([]),[N,y]=useState([]),[w,C]=useState(null),k=useRef(null);useEffect(()=>{(async()=>{try{const p=await fetch("resources.json");if(!p.ok)throw new Error("Failed to load resources");const n=(await p.json()).map(normalizeResource);l(n),x(n.map(u=>u.id)),k.current=createSearchIndex(n)}catch(p){console.error(p),c("Unable to load the resource catalogue at this time.")}finally{o(!1)}})()},[]),useEffect(()=>{if(!g){x(s.map(t=>t.id));return}if(k.current){const t=k.current.search(g,100);x(Array.isArray(t)?t:[])}else{const t=g.toLowerCase(),p=s.filter(i=>[i.name,i.shortName,i.icCode,i.icName,i.domains.join(" "),i.resourceTypes.join(" "),i.typicalUseCases,i.keywords.join(" ")].filter(Boolean).some(n=>n.toLowerCase().includes(t))).map(i=>i.id);x(p)}},[g,s]);const I=useMemo(()=>({ics:uniqueSorted(s.flatMap(t=>t.maintainingICs.length?t.maintainingICs:t.icCode?[t.icCode]:[])),domains:uniqueSorted(s.flatMap(t=>t.domains)),resourceTypes:uniqueSorted(s.flatMap(t=>t.resourceTypes))}),[s]),f=useMemo(()=>{const t=new Map(s.map(n=>[n.id,n]));let i=[...g?h.map(n=>t.get(n)).filter(Boolean):s];return g&&i.length===0?[]:(m.length&&(i=i.filter(n=>(n.maintainingICs.length?n.maintainingICs:n.icCode?[n.icCode]:[]).some(M=>m.includes(M)))),a.length&&(i=i.filter(n=>n.domains.some(u=>a.includes(u)))),N.length&&(i=i.filter(n=>n.resourceTypes.some(u=>N.includes(u)))),i)},[s,g,h,m,a,N]);useEffect(()=>{if(!f.length){C(null);return}C(t=>t&&f.some(p=>p.id===t)?t:f[0].id)},[f]);const R=(t,p,i)=>{i(n=>n.includes(t)?n.filter(u=>u!==t):[...n,t])},A=()=>{b([]),d([]),y([])},S=useMemo(()=>I.ics.filter(t=>!!getIcAssets(t).small),[I.ics]),_=t=>{C(p=>p===t?null:t)};if(e)return React.createElement("div",{className:"flex min-h-screen items-center justify-center text-slate-500"},"Loading resources...");if(r)return React.createElement("div",{className:"flex min-h-screen flex-col items-center justify-center space-y-3 text-center"},React.createElement("p",{className:"text-lg font-semibold text-slate-800"},r),React.createElement("p",{className:"text-sm text-slate-500"},"Check the JSON file and reload the page."));const D=f.length;return React.createElement("div",{className:"mx-auto max-w-7xl px-4 py-8 lg:px-8"},React.createElement("header",{className:"mb-8"},React.createElement("p",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-indigo-600"},"NIH Resource Finder"),React.createElement("div",{className:"mt-2 flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between"},React.createElement("div",null,React.createElement("h1",{className:"text-3xl font-bold text-slate-900"},"Search, filter, and launch NIH-supported research resources"),React.createElement("p",{className:"mt-2 max-w-3xl text-base text-slate-600"},"Explore data repositories, biospecimen banks, and analysis tools. Use the NIH logo picker and lightweight combobox filters to focus on the institutes, domains, and resource types that matter most.")),React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white px-4 py-3 text-right shadow-sm"},React.createElement("p",{className:"text-3xl font-semibold text-slate-900"},s.length),React.createElement("p",{className:"text-xs uppercase tracking-widest text-slate-500"},"Total resources")))),React.createElement("div",{className:"grid gap-6 lg:grid-cols-12"},React.createElement("aside",{className:"lg:col-span-4"},React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h2",{className:"text-sm font-semibold uppercase tracking-wide text-slate-500"},"Filters"),React.createElement("button",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-600 hover:text-indigo-500",onClick:A},"Clear all")),React.createElement("div",{className:"mt-4 space-y-6"},React.createElement(LogoFilterGrid,{options:S,selected:m,onToggle:t=>R(t,m,b)}),React.createElement(MultiEntryInput,{label:"Maintaining IC",placeholder:"Type an IC code",options:I.ics,values:m,onChange:b}),React.createElement(MultiEntryInput,{label:"Domain",placeholder:"Add a domain",options:I.domains,values:a,onChange:d}),React.createElement(MultiEntryInput,{label:"Resource type",placeholder:"Add a resource type",options:I.resourceTypes,values:N,onChange:y})))),React.createElement("main",{className:"space-y-4 lg:col-span-8"},React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm"},React.createElement("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:gap-4"},React.createElement("div",{className:"flex-1"},React.createElement("label",{className:"sr-only",htmlFor:"resource-search"},"Search resources"),React.createElement("div",{className:"relative"},React.createElement("span",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-slate-400"},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M10.5 3.75a6.75 6.75 0 1 1 0 13.5 6.75 6.75 0 0 1 0-13.5zm0 0L16.5 15"}))),React.createElement("input",{id:"resource-search",type:"search",placeholder:"Search by resource name, domain, or keyword",value:g,onChange:t=>v(t.target.value),className:"w-full rounded-xl border border-slate-200 bg-slate-50 py-3 pl-10 pr-4 text-sm text-slate-700 focus:border-indigo-400 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100"}))),React.createElement("div",{className:"flex items-center gap-3 text-sm text-slate-500"},React.createElement("span",{className:"text-sm font-semibold text-slate-900"},D),"results"))),D===0?React.createElement("div",{className:"rounded-2xl border border-dashed border-slate-300 bg-white p-10 text-center text-slate-500"},React.createElement("p",{className:"text-lg font-semibold text-slate-700"},"No resources found"),React.createElement("p",{className:"mt-2 text-sm text-slate-500"},"Adjust your filters or search query to discover more NIH resources.")):React.createElement("div",{className:"space-y-4"},f.map(t=>React.createElement(ResourceCard,{key:t.id,resource:t,isExpanded:w===t.id,onToggle:_}))))))};ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(App,null));
